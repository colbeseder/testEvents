<span><span id="counter"></span> events found. <span id="prev"></span></span><br>
<span>Right-click to save list of events:</span><br>
<a id="saveLink" download='events.txt' href="">events.txt</a>
<br>
<textarea id="output" cols=150 rows=20 >
</textarea>


<script src="./scripts/getEvents.js"> </script>

<script>
//Browser detect
var browser = (function (agent) {
    switch (true) {
        case agent.indexOf("edge") > -1: return "edge";
        case agent.indexOf("edg") > -1: return "edge";
        case agent.indexOf("opr") > -1 && !!window.opr: return "opera";
        case agent.indexOf("chrome") > -1 && !!window.chrome: return "chrome";
        case agent.indexOf("trident") > -1: return "ie";
        case agent.indexOf("firefox") > -1: return "firefox";
        case agent.indexOf("safari") > -1: return "safari";
        default: return "other";
    }
})(window.navigator.userAgent.toLowerCase());
</script>

<script>

var eventsFileName = browser + "_events.txt";


/* Get full list of element events */
var result = getEvents(filter='window');
console.log(result);
var eventSet = new Set();
for (var k in result) {
    let c = result[k];
    for (var i = 0; i < c.length; i++) {
        eventSet.add(c[i])
    }
}

/* Get previous list */
fetch("out/" + eventsFileName)
	.then(response => response.text())
	.then(data => document.getElementById("prev").innerText = "Previous count: " + data.split(/\s+/).length)

/* Update page */
document.getElementById("counter").innerText = Array.from(eventSet).length;
document.getElementById("output").innerHTML = Array.from(eventSet).join("\n");
var saveLink = document.getElementById("saveLink");
saveLink.innerText = eventsFileName;
saveLink.download = eventsFileName;
saveLink.href = "data:text/plain;base64," + btoa(Array.from(eventSet).join("\n"));
</script>